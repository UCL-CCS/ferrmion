"""Tests for base fermion to qubit encoding class"""
import pytest
import numpy as np
from ferrmion import TernaryTree

def test_edge_operator_map():
    four_jw = TernaryTree(np.ones((4,4)), np.zeros((4,4,4,4))).JW()
    edge_map, weights = four_jw._edge_operator_map()
    assert edge_map == {
        (0, 0): {'[0 0 0 0 0 0 0 0]': 1, '[0 0 0 0 1 0 0 0]': -1},
        (0, 1): {'[1 1 0 0 1 1 0 0]': -2, '[1 1 0 0 0 0 0 0]': 2},
        (0, 2): {'[1 0 1 0 1 1 1 0]': -2, '[1 0 1 0 0 1 0 0]': 2},
        (0, 3): {'[1 0 0 1 1 1 1 1]': -2, '[1 0 0 1 0 1 1 0]': 2},
        (1, 1): {'[0 0 0 0 0 0 0 0]': 1, '[0 0 0 0 0 1 0 0]': -1},
        (1, 2): {'[0 1 1 0 0 1 1 0]': -2, '[0 1 1 0 0 0 0 0]': 2},
        (1, 3): {'[0 1 0 1 0 1 1 1]': -2, '[0 1 0 1 0 0 1 0]': 2},
        (2, 2): {'[0 0 0 0 0 0 0 0]': 1, '[0 0 0 0 0 0 1 0]': -1},
        (2, 3): {'[0 0 1 1 0 0 1 1]': -2, '[0 0 1 1 0 0 0 0]': 2},
        (3, 3): {'[0 0 0 0 0 0 0 0]': 1, '[0 0 0 0 0 0 0 1]': -1}}
    assert np.all(weights == [[-0.5,  0. ,  0. ,  0. ],
        [ 0. , -0.5,  0. ,  0. ],
        [ 0. ,  0. , -0.5,  0. ],
        [ 0. ,  0. ,  0. , -0.5]])

